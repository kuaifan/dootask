import{n as l,m as u}from"./app.fe1cd649.js";var d=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ETooltip",{attrs:{"open-delay":e.openDelay,disabled:e.$isEEUiApp||e.windowTouch||e.tooltipDisabled||e.isBot,placement:e.tooltipPlacement}},[e.user?t("div",{staticClass:"common-avatar-transfer",attrs:{slot:"content"},slot:"content"},[e._t("default"),t("p",[e._v(e._s(e.$L("\u6635\u79F0"))+": "+e._s(e.user.nickname)),e.user.delete_at?t("em",{staticClass:"deleted no-dark-content"},[e._v(e._s(e.$L("\u5DF2\u5220\u9664")))]):e.user.disable_at?t("em",{staticClass:"disabled no-dark-content"},[e._v(e._s(e.$L("\u5DF2\u79BB\u804C")))]):e._e()]),t("p",{staticClass:"department-name",attrs:{title:e.user.department_name||""}},[e._v(e._s(e.$L("\u90E8\u95E8"))+": "+e._s(e.user.department_name||"-"))]),t("p",[e._v(e._s(e.$L("\u804C\u4F4D/\u804C\u79F0"))+": "+e._s(e.user.profession||"-"))]),e.user.delete_at?t("p",[t("strong",[e._v(e._s(e.$L("\u5220\u9664\u65F6\u95F4"))+": "+e._s(e.user.delete_at))])]):e.user.disable_at?t("p",[t("strong",[e._v(e._s(e.$L("\u79BB\u804C\u65F6\u95F4"))+": "+e._s(e.user.disable_at))])]):e._e(),e._t("end"),e.showMenu?t("div",{staticClass:"avatar-icons"},[t("Icon",{attrs:{type:"ios-chatbubbles"},on:{click:e.onOpenDialog}})],1):e._e()],2):e._e(),t("div",[t("UserAvatar",{ref:"avatar",attrs:{userid:e.userid,size:e.size,showIcon:e.showIcon,showName:e.showName,nameText:e.nameText,borderWitdh:e.borderWitdh,borderColor:e.borderColor,clickOpenDialog:e.clickOpenDialog,userResult:e.onUserResult}})],1)])},c=[];const _={name:"UserAvatarTip",mixins:[u],props:{tooltipDisabled:{type:Boolean,default:!1},showIconMenu:{type:Boolean,default:!1},tooltipPlacement:{type:String,default:"bottom"},openDelay:{type:Number,default:600}},data(){return{user:null}},mounted(){this.$listeners["update:online"]&&(this.$watch("userid",()=>{this.updateOnline()}),this.$watch("user.online",()=>{this.updateOnline()}),this.updateOnline())},computed:{showMenu(){return this.$store.state.userId==this.userid||this.user.delete_at||this.user.disable_at?!1:this.showIconMenu},isBot(){return!!(this.user&&this.user.bot)}},methods:{onOpenDialog(){this.$refs.avatar.openDialog()},onUserResult(e){typeof this.userResult=="function"&&this.userResult(e),this.user=e},updateOnline(){if(!!this.user)if(this.user.online||this.$store.state.userId===this.userid)this.$emit("update:online",!0);else{const e=$A.daytz(),s=$A.dayjs(this.user.line_at),t=e.unix()-s.unix();let n="\u6700\u540E\u5728\u7EBF\u4E8E\u5F88\u4E45\u4EE5\u524D";if(t<60)n="\u6700\u540E\u5728\u7EBF\u4E8E\u521A\u521A";else if(t<3600)n=`\u6700\u540E\u5728\u7EBF\u4E8E ${Math.floor(t/60)} \u5206\u949F\u524D`;else if(t<3600*6)n=`\u6700\u540E\u5728\u7EBF\u4E8E ${Math.floor(t/3600)} \u5C0F\u65F6\u524D`;else{const r=e.format("YYYY-MM-DD"),a=s.format("YYYY-MM-DD"),i=s.format("HH:mm");r===a?n=`\u6700\u540E\u5728\u7EBF\u4E8E\u4ECA\u5929 ${i}`:e.clone().subtract(1,"day").format("YYYY-MM-DD")===a?n=`\u6700\u540E\u5728\u7EBF\u4E8E\u6628\u5929 ${i}`:t<3600*24*365&&(n=`\u6700\u540E\u5728\u7EBF\u4E8E ${a}`)}this.$emit("update:online",this.$L(n))}}}},o={};var p=l(_,d,c,!1,h,null,null,null);function h(e){for(let s in o)this[s]=o[s]}var f=function(){return p.exports}();export{f as U};
